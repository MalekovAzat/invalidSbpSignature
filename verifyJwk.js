import jwkToBuffer from "jwk-to-pem";
import { verify } from "jsonwebtoken";
import { readFileSync } from "fs";

const jwk = JSON.parse(readFileSync("./keys/jwk.json").toString());

const incomingPaymentToken =
  "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJTaWRlUGF5ZXIiOiB7ImJhbmtDb2RlIjogIjAwMDAwMDAwMCIsICJiYW5rTmFtZSI6ICJcdTA0MjJcdTA0MWVcdTA0MjdcdTA0MWFcdTA0MTAgXHUwNDFmXHUwNDEwXHUwNDFlIFx1MDQxMVx1MDQxMFx1MDQxZFx1MDQxYVx1MDQxMCBcIlx1MDQyNFx1MDQxYSBcdTA0MWVcdTA0MjJcdTA0MWFcdTA0MjBcdTA0MmJcdTA0MjJcdTA0MThcdTA0MTVcIiIsICJiYW5rQ29ycmVzcG9uZGVudEFjY291bnQiOiAiMDAwMDAwMDAwMDAwMDAwMDAwMDAiLCAiYWNjb3VudCI6ICIwMDAwMDAwMDAwMDAwMDAwMDAwMCIsICJuYW1lIjogIlx1MDQxOFx1MDQxZiBcdTA0MjJcdTA0MzVcdTA0NDFcdTA0NDIiLCAiYW1vdW50IjogIjQwLjAiLCAiY3VycmVuY3kiOiAiUlVCIiwgImlubiI6ICIwMDAwMDAwMDAwIiwgImtwcCI6ICIwMDAwMDAwMDAwIn0sICJTaWRlUmVjaXBpZW50IjogeyJiYW5rQ29kZSI6ICIwMDAwMDAwMDAiLCAiYmFua05hbWUiOiAiXHUwNDIyXHUwNDFlXHUwNDI3XHUwNDFhXHUwNDEwIFx1MDQxZlx1MDQxMFx1MDQxZSBcdTA0MTFcdTA0MTBcdTA0MWRcdTA0MWFcdTA0MTAgXCJcdTA0MjRcdTA0MWEgXHUwNDFlXHUwNDIyXHUwNDFhXHUwNDIwXHUwNDJiXHUwNDIyXHUwNDE4XHUwNDE1XCIiLCAiYmFua0NvcnJlc3BvbmRlbnRBY2NvdW50IjogIjAwMDAwMDAwMDAwMDAwMDAwMDAwIiwgImFjY291bnQiOiAiMDAwMDAwMDAwMDAwMDAwMDAwMDAiLCAibmFtZSI6ICJcdTA0MThcdTA0MWYgXHUwNDIyXHUwNDM1XHUwNDQxXHUwNDQyIiwgImFtb3VudCI6ICI0MC4wIiwgImN1cnJlbmN5IjogIlJVQiIsICJpbm4iOiAiMDAwMDAwMDAwMCIsICJrcHAiOiAiMDAwMDAwMDAwMCJ9LCAicHVycG9zZSI6ICJcdTA0MjJcdTA0MzVcdTA0NDFcdTA0NDJcdTA0M2VcdTA0MzJcdTA0M2VcdTA0MzUgXHUwNDNkXHUwNDMwXHUwNDM3XHUwNDNkXHUwNDMwXHUwNDQ3XHUwNDM1XHUwNDNkXHUwNDM4XHUwNDM1IFx1MDQzZlx1MDQzYlx1MDQzMFx1MDQ0Mlx1MDQzNVx1MDQzNlx1MDQzMCIsICJkb2N1bWVudE51bWJlciI6ICIwMDAwMCIsICJkYXRlIjogIjIwMTgtMTAtMDEifQ.C6W3u2phzF_R2Q3y2fqSsxpNvxskl3nIsFh6Pd9rMpuzfWu8RK821OcOpBYjJGqLUyaVoZdEW_2X-F6M0ChQKpaqQM7-9roYeKKE-Ybs6-AcH5dDPffVXpXfvm6NAK3Oqm6yEv05-0OrT8o-tEpIXi3nSz0PwSP0HMc5g4zn6WancaII4I4bnz_nvplR_rMxsQZKo9kr1LXWkTYzMX86BVBzX5e7IKQ_nMykdiDoU3GFV-F_7kXCCplSPEJ7MXvRyab2WHYzYdb73u9UUPU2mX1y_BfoT5LTvcNM27urc3az7nf5aJhaoHkSSviAk4QmUgZGJbNykQ_nJNAY6N7Y-oGAHW8ECXNm7Ge6aKZmYX1kO3fURuoz040i0WMLynS0LeUUNEs7xd7ukN8x_b6j6RsQwCJxY0WRIXGa4vIgknqXrB3o7ksTVx0hsYXCsDj26Re2aW467CP-tcTL929asPae2nM4i9fc6Pg7lR8FZ6ckkAGex3lgXbLmkLlL-OO5";

const incomingSbpPaymentToken =
  "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJvcGVyYXRpb25JZCI6ICJBMjIwMDExMDAyNjM4MjAxMDAwMDA1MzNFNjI1RkNCMyIsICJxcmNJZCI6ICJBUzEwMDA2RFBSVEVGUEZTOUhKOVNRU0RTVlJISkQzTCIsICJhbW91bnQiOiAiMC4zMyIsICJwYXllck1vYmlsZU51bWJlciI6ICIrOTk5OTEyMzQ1NjciLCAicGF5ZXJOYW1lIjogIlx1MDQxOFx1MDQzMlx1MDQzMFx1MDQzZCBcdTA0MThcdTA0MzJcdTA0MzBcdTA0M2RcdTA0M2VcdTA0MzJcdTA0MzhcdTA0NDcgXHUwNDE4LiJ9.lDAckpxnXhzFvkGMNpmMugovwTgNCltTGNc5KIDgirCFH67eK7hVyhpxZLs3DUq43kVv7uymwD4N8EVgCdUcszOvpVRV7FCd6j_ymWMtMTMmtSzZ44rO-SqPfeYOvakHgnyGuaWZCSdZm6WIUfPV4ev0eltiWdXKiK6DGjDbwZR7tm0e9rsoHTh_EhcD6WTNijd0aXk0w3MoVSdUu7E-Sr_Tf0sXkVbMMiVV-oRmvbkVZ_YNeTr0Y8-lSbJ9xBDQU2cuJDf0Evw44fQ_1J_wi8rCiEzSlrLIi-413Fe372EK-ZfAWzkv6ci7S9dA5QhQkMlb9Crr4T60RuhF8BWGu5QdPBaicmOL2s_fi2d94HGaOBvz0S81adUDCJerEwOHgvk8vwUFrioKFTUWLB-b4CPYhKreng-NpznET27ayTQZmCKlpOREyPF_qdaCtH-lpW_e1Jbl8fHZXrOBMgAT0ExOmWlQVPG_6Q6krkIJXNKiAzBxk_gLhP73UiBJJTK7";

verify(incomingPaymentToken, jwkToBuffer(jwk), (err, payload) => {
  console.log("incomingPaymentToken");
  console.log(err);
  console.log(payload);
});

// error here
verify(incomingSbpPaymentToken, jwkToBuffer(jwk), (err, payload) => {
  console.log("incomingSbpPaymentToken");
  console.log(err);
  console.log(payload);
});

export default {};
